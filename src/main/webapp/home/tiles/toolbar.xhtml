<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:ui="http://java.sun.com/jsf/facelets">
<body>
	<ui:composition>
		<h:outputScript name="js/loopj-jquery-tokeninput/src/jquery.tokeninput.js" target="head" />
		<h:outputStylesheet name="js/loopj-jquery-tokeninput/styles/token-input.css" target="head" />
		<h:outputStylesheet name="js/loopj-jquery-tokeninput/styles/token-input-mac.css" target="head" />
		<h:outputStylesheet name="js/loopj-jquery-tokeninput/styles/token-input-facebook.css" target="head" />
		<h:outputScript target="head">
		    $(document).ready(function() {
		    	$("#searchForm\\:searchObjet")
		    		.autocomplete({
				    	source: "#{facesContext.externalContext.requestContextPath}/rest/providers/amazon/",
			    		minLength: 2,
			    		focus: function(event, ui) {
				            $("#searchForm\\:searchCity").val(ui.item.name);
				            return false;
				        },
			    		select: function( event, ui ) {
				            $("#searchForm\\:searchObjet").val(ui.item.name);
				            $("#searchForm\\:searchObjetHidden").val(ui.item.id);
				            return false;
			            },
			            open: function(){
							$(this).autocomplete("widget").css("z-index", 100);
							return false;
					   	}
		    		})
		    		.val("Recherche").toggleClass("backgroundText", true)
					.focus(function(){
						if($(this).hasClass("backgroundText")){
		    				$(this).val("").toggleClass("backgroundText", false);
	    				}
		    		})
		    		.blur(function(){
		    			if($(this).val() == ""){
		    				$(this).val("Recherche").toggleClass("backgroundText", true);
	    				}
		    		});
		    		
				$("#searchForm\\:searchCity").tokenInput(
					"#{facesContext.externalContext.requestContextPath}/rest/search/locations/",
					 {
					 	theme: "facebook",
		    			hintText: "Code postal ou Ville",
					 	tokenValue: "amazonId",	
					 	queryParam: "term"
					 }       
				);
		    	$("#token-input-searchForm\\:searchCity")
		    		.val("Lieu(x)").toggleClass("backgroundText", true)
					.focus(function(){
		    			$(this).val("").toggleClass("backgroundText", false);
		    		})
		    		.blur(function(){
		    			$(this).val("Lieu(x)").toggleClass("backgroundText", true)
		    		});
		    	//TODO : make a function to render input with label
		    	$("#searchForm\\:searchMember")
		    		.val("TroQMember").toggleClass("backgroundText", true)
					.focus(function(){
						if($(this).hasClass("backgroundText")){
			    			$(this).val("").toggleClass("backgroundText", false);
		    			}
		    		})
		    		.blur(function(){
		    			if($(this).val() == ""){
		    				$(this).val("TroQMember").toggleClass("backgroundText", true)
	    				}
		    		});
    		});
		</h:outputScript>
		<div id="toolbar">
			<!-- May use an include there -->
			<h:form id="searchForm">
				<fieldset>
					<div id="searchPart2">
						<div id="cityBox">
							<h:inputText id="searchCity"  />
							<h:inputHidden id="searchCityId"  />
						</div>
					</div>
					<div id="searchPart1">
						<div id="searchObjetBox" class="searchBox">
							<h:inputText id= "searchObjet" value="Recherche d'objet" />
							<h:inputHidden id="searchObjetHidden"  />
						</div>
						<div id="searchMemberBox" class="searchBox">
							<h:inputText id="searchMember" value="Recherche" />
						</div>
					</div>
					<h:commandButton id="bouton" value="Rechercher !" type="button" />
					<h:link outcome="/item/newItem">DÃ©poser une annonce</h:link>
				</fieldset>
			</h:form>
		</div>
	</ui:composition>
</body>
</html>